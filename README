# JWT Authentication in TypeScript

Este projeto implementa a criaÃ§Ã£o e verificaÃ§Ã£o de JSON Web Tokens (JWT) utilizando TypeScript e Node.js.

## ğŸš€ Tecnologias Utilizadas
- **Node.js**
- **TypeScript**
- **Crypto (mÃ³dulo nativo do Node.js)**

## ğŸ“Œ Funcionalidades
- **Gerar assinaturas HMAC SHA-256**
- **Criar tokens JWT**
- **Verificar e validar tokens JWT**

---

## ğŸ“‚ Estrutura do Projeto

```
ğŸ“ projeto-jwt
â”œâ”€â”€ ğŸ“‚ jwt
â”‚   â”œâ”€â”€ generateSignature.ts  # Gera a assinatura do JWT
â”‚   â”œâ”€â”€ sign.ts               # Cria um token JWT
â”‚   â”œâ”€â”€ verify.ts             # Verifica a validade do JWT
â”œâ”€â”€ index.ts                  # Testa geraÃ§Ã£o e verificaÃ§Ã£o do JWT
â””â”€â”€ README.md                 # DocumentaÃ§Ã£o do projeto
```

---

## ğŸ› ï¸ InstalaÃ§Ã£o e Uso

### ğŸ”¹ 1. Clonar o repositÃ³rio
```sh
git clone https://github.com/seu-usuario/projeto-jwt.git
cd projeto-jwt
```

### ğŸ”¹ 2. Instalar dependÃªncias
```sh
npm install
```

### ğŸ”¹ 3. Rodar o projeto
```sh
npm run dev
```

---

## ğŸ“ CÃ³digo Explicado

### ğŸ”¹ Gerando a Assinatura (`generateSignature.ts`)
A funÃ§Ã£o `generateSignature` utiliza o mÃ³dulo `crypto` para criar um hash HMAC SHA-256 com base no cabeÃ§alho e no payload do token.

```ts
import { createHmac } from "node:crypto"

interface IGenerateSignatureOptions {
    header: string,
    payload: string,
    secret: string
}

export function generateSignature({ header, payload, secret }: IGenerateSignatureOptions) {
    const hmac = createHmac("sha256", secret)
    return hmac.update(`${header}.${payload}`).digest("base64url")
}
```

### ğŸ”¹ Criando um Token JWT (`sign.ts`)
A funÃ§Ã£o `sign` cria um token JWT com um cabeÃ§alho, payload e assinatura.

```ts
import { generateSignature } from "./generateSignature"

interface ISignOptions {
    exp: number
    data: Record<string, any>
    secret: string
}

export function sign({ data, exp, secret }: ISignOptions): string {
    const header = { alg: 'HS256', typ: "JWT" }
    const payload = { ...data, iat: Date.now(), exp: exp }
    
    const base64EncodedHeader = Buffer.from(JSON.stringify(header)).toString("base64url")
    const base64EncodedPayload = Buffer.from(JSON.stringify(payload)).toString("base64url")
    
    const signature = generateSignature({ header: base64EncodedHeader, payload: base64EncodedPayload, secret })

    return `${base64EncodedHeader}.${base64EncodedPayload}.${signature}`
}
```

### ğŸ”¹ Verificando um Token JWT (`verify.ts`)
A funÃ§Ã£o `verify` verifica se um token JWT Ã© vÃ¡lido e nÃ£o expirou.

```ts
import { generateSignature } from "./generateSignature"

interface IVerifyOptions {
    token: string,
    secret: string
}

export function verify({ secret, token }: IVerifyOptions) {
    const [headerSent, payloadSent, signatureSent] = token.split(".")
    
    const signature = generateSignature({ header: headerSent, payload: payloadSent, secret })
    
    if (signature !== signatureSent) {
        throw new Error("Invalid JWT token")
    }
    
    const decodedPayload = JSON.parse(Buffer.from(payloadSent, 'base64url').toString("utf-8"))
    
    if (decodedPayload.exp < Date.now()) {
        throw new Error("Expired Token")
    }
    return decodedPayload
}
```

### ğŸ”¹ Testando o JWT (`index.ts`)
O cÃ³digo abaixo cria um token JWT e depois verifica sua validade.

```ts
import { sign } from "./jwt/sign"
import { verify } from "./jwt/verify"

const secret = "my-secret"

const token = sign({
    exp: Date.now() + 24 * 60 * 60 * 1000,
    data: { sub: "@joaogabriel1995" },
    secret: secret
})

const decoded = verify({
    token,
    secret,
})

console.log(decoded)
```

---

## ğŸ” SeguranÃ§a
- **O segredo deve ser mantido seguro**, idealmente usando variÃ¡veis de ambiente (`process.env.SECRET`).
- **ExpiraÃ§Ã£o curta para os tokens** reduz riscos de uso indevido.

---
